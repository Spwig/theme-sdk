{% extends "layout.html" %}

{% block title %}{{ collection.title }} - {{ store.name }}{% endblock %}

{% block body_class %}page-collection{% endblock %}

{% block content %}
  <div class="collection-page">
    <header class="collection-header">
      <h1>{{ collection.title }}</h1>
      {% if collection.description %}
        <div class="collection-description">{{ collection.description|safe }}</div>
      {% endif %}
    </header>

    <div class="collection-controls">
      <div class="sort-by">
        <label for="sort">Sort by:</label>
        <select id="sort" name="sort">
          <option value="featured">Featured</option>
          <option value="price-asc">Price: Low to High</option>
          <option value="price-desc">Price: High to Low</option>
          <option value="title-asc">Alphabetically: A-Z</option>
          <option value="created-desc">Newest First</option>
        </select>
      </div>

      <p class="product-count">
        {{ products|length }} product{{ products|length|pluralize }}
      </p>
    </div>

    <div class="product-grid">
      {% for product in products %}
        <div class="product-card">
          <a href="{{ product.url }}" class="product-link">
            <div class="product-image">
              {% if product.image %}
                <img src="{{ product.image }}" alt="{{ product.title }}" loading="lazy">
              {% endif %}

              {% if product.compare_at_price %}
                <span class="sale-badge">Sale</span>
              {% endif %}
            </div>

            <div class="product-info">
              <h3 class="product-title">{{ product.title }}</h3>
              <div class="product-price">
                {% if product.compare_at_price %}
                  <span class="sale-price">{{ product.price|currency }}</span>
                  <span class="compare-price">{{ product.compare_at_price|currency }}</span>
                {% else %}
                  {{ product.price|currency }}
                {% endif %}
              </div>
            </div>
          </a>
        </div>
      {% empty %}
        <p class="no-products">No products found in this collection.</p>
      {% endfor %}
    </div>

    {% if products.has_other_pages %}
      <nav class="pagination" aria-label="Pagination">
        {% if products.has_previous %}
          <a href="?page={{ products.previous_page_number }}">Previous</a>
        {% endif %}

        <span class="page-info">
          Page {{ products.number }} of {{ products.paginator.num_pages }}
        </span>

        {% if products.has_next %}
          <a href="?page={{ products.next_page_number }}">Next</a>
        {% endif %}
      </nav>
    {% endif %}
  </div>
{% endblock %}
